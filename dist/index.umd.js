(function(i,g){typeof exports=="object"&&typeof module<"u"?g(exports,require("clipboard"),require("gcoord")):typeof define=="function"&&define.amd?define(["exports","clipboard","gcoord"],g):(i=typeof globalThis<"u"?globalThis:i||self,g(i.FanUtils={},i.ClipboardJS,i.gcoord))})(this,function(i,g,h){"use strict";const y=(e,...t)=>{console.warn("FanUtils:",e,...t)},l=typeof window<"u";function C(e){return e instanceof Promise||typeof(e==null?void 0:e.then)=="function"}const M=e=>/^1[3-9]{1}\d{9}$/.test(e);function N(e){const t=[];let n=!1;return(...o)=>new Promise(async(r,a)=>{if(t.push({resolve:r,reject:a}),!n){n=!0;try{const c=await e(...o);t.forEach(s=>s.resolve(c))}catch(c){t.forEach(s=>s.reject(c))}t.length=0,n=!1}})}function p(e){return""+((e==null?void 0:e.prefix)||"")+Math.floor(Math.random()*1e6).toString(36)}const P=(e,t=!1)=>{const n=e.replace(/-(\w)/g,(o,r)=>r.toUpperCase());return t?`${n[0].toUpperCase()}${n.substring(1)}`:n},v=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase());function T(e,t=150){let n=0;return function(...o){const r=Date.now();r-n>t&&(e.apply(this,o),n=r)}}function D(e,t=200,n=!1){let o;return function(...r){if(o&&clearTimeout(o),n)return o=null,e.apply(this,r);o=setTimeout(()=>e.apply(this,r),t)}}function b(e,t=1){if(t<0)return e;const n=decodeURIComponent(e);if(t===0&&n.includes("%"))return b(n,0);const o=t-1;return o<=0?n:b(n,o)}const E=(e=0)=>new Promise(t=>{setTimeout(()=>t(!0),e)}),S=()=>{if(!l)return{};const e=navigator.userAgent,t=/macintosh|mac os x/i.test(e),n=/micromessenger/.test(e.toLowerCase());return{devicePixelRatio:window.devicePixelRatio,language:navigator.language,windowHeight:window.innerHeight,windowWidth:window.innerWidth,statusBarHeight:0,navBarHeight:0,isMac:t,isIos:/(iPhone|iPad|iPod|iOS)/i.test(e)||t,isWeixin:n,isAlipay:/alipay/.test(e.toLowerCase()),isMpWebWeixin:n&&e.includes("miniProgram")}},I=e=>(l&&(window.location.href="tel:"+e),new Promise(t=>t(e))),W=e=>{!e||!l||(document.title=e)},$=e=>{},H=async e=>{if(l){var t=document.createElement("a");t.href=e,t.target="_blank",t.download=`${p()}`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},Y=()=>l?location.href:"",k=()=>new Promise(e=>{if(!window.my||!window.my.getEnv)return e(!1);const t=setTimeout(()=>{e(!1)},2e3);window.my.getEnv(n=>{clearTimeout(t),e(n.miniprogram)})}),A=(e,t)=>new Promise((n,o)=>{const r=document.createElement("script");if(t)for(let a in t)r.setAttribute(a,t[a]);r.src=e,r.onload=n,r.onerror=a=>{document.head.removeChild(r),o(a)},document.head.appendChild(r)}),L=e=>new Promise((t,n)=>{if(!l){t({text:e});return}const o=document.createElement("button"),r=new g(o,{text:()=>e||"",action:()=>"copy",container:document.body});r.on("success",a=>{r.destroy(),t(a)}),r.on("error",()=>{r.destroy(),n(new Error(g.isSupported()?"复制失败，请手动复制":"浏览器不支持一键复制，请手动复制"))}),document.body.appendChild(o),o.click(),document.body.removeChild(o)}),f=(e,t=2,n)=>{const o=Number(e);if(isNaN(o))return 0;const{floor:r}=n||{},a=Math.pow(10,t+1),c=Math.pow(10,t);return(r?Math.floor(o*a/10):Math.round(o*a/10))/c},w=(e,t=2,n)=>{const{right:o,sign:r="0"}=n||{},a=String(e);let c="";const s=t-a.length;if(s>0)for(let u=0;u<s;u++)c+=r;return o?`${a}${c}`:`${c}${a}`},B=(e,t)=>{const{lang:n="zh",plusSign:o=!1,decimal:r,floor:a=!0}=t||{},c=n==="zh"?1e4:1e3,s=typeof r=="number"?r:n==="zh"?2:1;if(e<c){if(o){if(e>1e3)return`${Math.floor(e/1e3)*1e3}+`;if(e>100)return`${Math.floor(e/100)*100}+`}return f(e,s,{floor:a})+""}let u;if(n==="zh"){const m=["","万","亿","万亿"],d=Math.floor(Math.log(e)/Math.log(c));u=f(e/Math.pow(c,d),s,{floor:a})+m[d]}else e>=1e6?u=f(e/1e6,s,{floor:a})+"m":e>=1e4?u=f(e/1e4,s,{floor:a})+"w":u=f(e/1e3,s,{floor:a})+"k";return`${u}${o?"+":""}`},U=e=>Number(e).toLocaleString(),z=(e,t,n)=>{if(!e||!l)return;const{expired:o=0,runTime:r}=n||{},a=JSON.stringify({t:Date.now(),expired:o,data:t});r?sessionStorage.setItem(e,a):localStorage.setItem(e,a)},G=(e,t)=>{if(!e||!l)return null;const{runTime:n,expired:o}=t||{};let r=n?sessionStorage.getItem(e):localStorage.getItem(e);if(!r)return r;try{r=JSON.parse(r)}catch(c){return y("Error getStorage parse..",c),r}const a=o||r.expired;return a&&r.t&&Date.now()-r.t>a?null:r.data},R=(e,t)=>{if(!l)return;const{runTime:n}=t||{};n?sessionStorage.removeItem(e):localStorage.removeItem(e)},F=e=>{if(!l)return;const{runTime:t}={...e};t?sessionStorage.clear():localStorage.clear()},J=e=>(e.length>19&&(e=e.substring(0,19).replace("T"," ")),new Date(e.replace(/-/g,"/"))),j=(e,t)=>{const{format:n="YYYY-MM-DD HH:mm:ss"}=t||{},o=e.getFullYear(),r=w(e.getMonth()+1,2),a=w(e.getDate(),2),c=w(e.getHours(),2),s=w(e.getMinutes(),2),u=w(e.getSeconds(),2);return n.replace("YYYY",`${o}`).replace("MM",r).replace("DD",a).replace("HH",c).replace("mm",s).replace("ss",u)},q=e=>{const{type:t="gcj02",timeout:n}=e||{};return new Promise((o,r)=>{if(!navigator.geolocation){r(new Error("该浏览器不支持获取地理位置"));return}navigator.geolocation.getCurrentPosition(a=>{const{accuracy:c,latitude:s,longitude:u}=a.coords;if(t==="gcj02"){const[m,d]=h.transform([u,s],h.WGS84,h.GCJ02);o({accuracy:c,latitude:Number(d),longitude:Number(m)});return}o({accuracy:c,latitude:Number(s),longitude:Number(u)})},a=>r(a),{enableHighAccuracy:!0,timeout:n,maximumAge:1e3*60})})},O=e=>{const{type:t="gcj02",timeout:n,weixinReady:o}=e||{};return new Promise((r,a)=>{var u;let c;(o||((u=window.fanWeixinSdk)==null?void 0:u.onConfigReady)||window.wx.ready)(()=>{n&&(c=setTimeout(()=>a(new Error("微信位置获取超时")),n)),window.wx.getLocation({type:t,success:m=>{c&&clearTimeout(c),r({latitude:Number(m.latitude),longitude:Number(m.longitude),accuracy:m.accuracy})},fail:m=>{c&&clearTimeout(c),a(new Error(m.errMsg))},cancel:()=>{c&&clearTimeout(c),a(new Error("用户取消了微信位置授权"))}})})})},_=async e=>{if(!l)return{accuracy:0,latitude:0,longitude:0,from:"browser"};const{type:t="gcj02",useWeixin:n=!0,timeout:o,weixinTimeout:r,weixinReady:a}=e||{},{isWeixin:c}=S();let s="";if(c&&n&&!!window.wx)try{return{...await O({type:t,timeout:r||o,weixinReady:a}),from:"weixin"}}catch(d){s+=`[wx]${d.message}`}return{...await q({type:t,timeout:o}),from:"browser",errMsg:s}};i.camelize=P,i.clearStorage=F,i.createUniqueId=p,i.dateFromString=J,i.debounce=D,i.decodeString=b,i.formatDate=j,i.getCurrentUrl=Y,i.getGeolocation=_,i.getStorage=G,i.getSystemInfo=S,i.inBrowser=l,i.isMpWebAlipay=k,i.isPromiseLike=C,i.kebabCase=v,i.libLogWarn=y,i.loadJs=A,i.makingCall=I,i.mergeConcurrent=N,i.padNumber=w,i.partNumber=U,i.removeStorage=R,i.roundNumber=f,i.saveImage=H,i.setClipboard=L,i.setNavigationBarColor=$,i.setPageTitle=W,i.setStorage=z,i.sleep=E,i.throttle=T,i.unitNumber=B,i.validatePhoneNumber=M,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
